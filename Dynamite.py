from machine import Pin, PWM
import utime

BUZZER_PIN = 12

NOTES = {
    'C4': 262, 'C#4': 277, 'D4': 294, 'D#4': 311, 'E4': 330, 'F4': 349,
    'F#4': 370, 'G4': 392, 'G#4': 415, 'A4': 440, 'A#4': 466, 'B4': 494,
    'C5': 523, 'C#5': 554, 'D5': 587, 'D#5': 622, 'E5': 659, 'F5': 698,
    'F#5': 740, 'G5': 784, 'G#5': 831, 'A5': 880, 'A#5': 932, 'B5': 988,
    'C6': 1047,
    'REST': 0
}

melody = [
    ('G#4', 0.25), ('A#4', 0.25), ('D#5', 0.25), ('C#5', 0.25), ('C5', 0.5), ('A#4', 0.25), ('REST', 0.25),
    ('G#4', 0.25), ('A#4', 0.25), ('D#5', 0.25), ('C#5', 0.25), ('C5', 0.5), ('A#4', 0.25), ('REST', 0.25),
    ('F5', 0.25), ('G#5', 0.25), ('A#5', 0.25), ('G#5', 0.25), ('REST', 0.25),
    ('F5', 0.25), ('G#5', 0.25), ('A#5', 0.25), ('G#5', 0.25), ('REST', 0.25),
    ('D#5', 0.5), ('C#5', 0.25), ('C5', 0.25), ('A#4', 0.5), ('C5', 0.25),
    ('D#5', 0.25), ('F5', 0.25), ('G#5', 0.25), ('G#5', 0.5),
    ('F5', 0.25), ('G#5', 0.25), ('D#5', 0.5), ('REST', 0.25),
    ('C#5', 0.25), ('D#5', 0.25), ('F5', 0.25), ('G#5', 0.25), ('G#5', 0.5),
    ('F5', 0.25), ('D#5', 0.25), ('C#5', 0.25), ('A#4', 0.25), ('C5', 0.25), ('A#4', 0.5),
    ('REST', 0.5),
    ('D#5', 0.25), ('F5', 0.25), ('G#5', 0.25), ('G#5', 0.5),
    ('F5', 0.25), ('G#5', 0.25), ('D#5', 0.5), ('REST', 0.25),
    ('C#5', 0.25), ('D#5', 0.25), ('F5', 0.25), ('G#5', 0.25), ('G#5', 0.5),
    ('F5', 0.25), ('D#5', 0.25), ('C#5', 0.25), ('A#4', 0.25), ('C5', 0.25), ('A#4', 0.5),
    ('REST', 0.5),
    ('D#5', 0.25), ('C#5', 0.25), ('A#4', 0.25), ('G#4', 0.25),
    ('F4', 0.5), ('G#4', 0.25), ('A#4', 0.25), ('C5', 0.25),
    ('D#5', 0.25), ('C#5', 0.25), ('D#5', 0.25), ('F5', 0.25),
    ('G#5', 0.5), ('F5', 0.5), ('D#5', 0.5), ('C#5', 0.5),
]

def play_note(buzzer_pwm, frequency, duration):
    if frequency > 0:
        buzzer_pwm.freq(frequency)
        buzzer_pwm.duty_u16(32768)
    else:
        buzzer_pwm.duty_u16(0)
    utime.sleep(duration)

def main():
    buzzer_pwm = PWM(Pin(BUZZER_PIN))
    try:
        for note, duration in melody:
            play_note(buzzer_pwm, NOTES[note], duration)
    except KeyboardInterrupt:
        pass
    finally:
        buzzer_pwm.duty_u16(0)
        buzzer_pwm.deinit()

if __name__ == '__main__':
    main()
